!function(){var a=Class.create(Taf.ActionFactory,{check:function(a,b,c){return void 0===c.uri||0!=c.uri.indexOf("http://dbpedia.org/resource")?!1:!0},legend:{name:"Wikipedia",description:"Show original Wikipedia page",lines:[{icon:"<span class='dbpvicon dbpvicon-wikipedia'></span>",text:"Opens the corresponding Wikipedia page"}]},action:Class.create(Taf.Action,{description:"View original Wikipedia page",display:function(){return"<span class='dbpvicon dbpvicon-wikipedia'></span>"},regex:/http\:\/\/(\w{2,3}\.)?dbpedia\.org\/resource\/(.+)/g,execute:function(a,b,c){var d=this.regex.exec(c.uri);void 0===d[1]&&(d[1]="");var e="http://"+d[1]+"wikipedia.org/wiki/"+d[2];window.open(e)}})});Taf.addAction(a);var b=Class.create(Taf.ActionFactory,{check:function(a,b,c){var d=new RegExp("^http://([a-z]+.)?dbpedia.org/resource/.+$");return void 0===c.uri||d.exec(c.uri)&&d.exec(a.uri)&&d.exec(c.uri)[1]!=d.exec(a.uri)[1]?!1:!0},legend:{name:"RelFinder",description:"View more relations on RelFinder",lines:[{icon:"<span class='dbpvicon dbpvicon-relfinder'></span>",text:"Opens RelFinder between the viewed entity and the object of the triple"}]},action:Class.create(Taf.Action,{description:"View more relations on RelFinder",display:function(){return"<span class='dbpvicon dbpvicon-relfinder'></span>"},execute:function(a,b,c){var d=new RegExp("^http://([a-z]+.)?dbpedia.org/resource/(.+)$"),e=encodeURIComponent(d.exec(a.uri)[2]),f=d.exec(a.uri)[1];void 0===f&&(f="");var g=encodeURIComponent(d.exec(c.uri)[2]),h=a.uri,i=c.uri;if(b.reverse){var j=e;e=g,g=j,j=h,h=i,i=j}var k=[];k.push("http://www.visualdataweb.org/relfinder/demo.swf"),k.push("?"),k.push("obj1="+this.to64(g+"|"+i)),k.push("&obj2="+this.to64(e+"|"+h)),k.push("&name="+this.to64("DBpedia")),k.push("&abbreviation="+this.to64("dbp")),k.push("&description="+this.to64("Linked Data version of Wikipedia")),k.push("&endpointURI="+this.to64("http://"+f+"dbpedia.org/sparql")),k.push("&dontAppendSPARQL="+this.to64("true")),k.push("&defaultGraphURI="+this.to64("http://"+f+"dbpedia.org")),k.push("&isVirtuoso="+this.to64("true")),k.push("&useProxy=ZmFsc2U=&method=UE9TVA==&autocompleteLanguage=ZW4=&autocompleteURIs=aHR0cDovL3d3dy53My5vcmcvMjAwMC8wMS9yZGYtc2NoZW1hI2xhYmVs&ignoredProperties=aHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zI3R5cGUsaHR0cDovL3d3dy53My5vcmcvMjAwNC8wMi9za29zL2NvcmUjc3ViamVjdCxodHRwOi8vZGJwZWRpYS5vcmcvcHJvcGVydHkvd2lraVBhZ2VVc2VzVGVtcGxhdGUsaHR0cDovL2RicGVkaWEub3JnL3Byb3BlcnR5L3dvcmRuZXRfdHlwZSxodHRwOi8vZGJwZWRpYS5vcmcvcHJvcGVydHkvd2lraWxpbmssaHR0cDovL3d3dy53My5vcmcvMjAwMi8wNy9vd2wjc2FtZUFzLGh0dHA6Ly9wdXJsLm9yZy9kYy90ZXJtcy9zdWJqZWN0&abstractURIs=aHR0cDovL2RicGVkaWEub3JnL29udG9sb2d5L2Fic3RyYWN0&imageURIs=aHR0cDovL2RicGVkaWEub3JnL29udG9sb2d5L3RodW1ibmFpbCxodHRwOi8veG1sbnMuY29tL2ZvYWYvMC4xL2RlcGljdGlvbg==&linkURIs=aHR0cDovL3B1cmwub3JnL29udG9sb2d5L21vL3dpa2lwZWRpYSxodHRwOi8veG1sbnMuY29tL2ZvYWYvMC4xL2hvbWVwYWdlLGh0dHA6Ly94bWxucy5jb20vZm9hZi8wLjEvcGFnZQ==&maxRelationLegth=Mg=="),window.open(k.join(""))},to64:function(a){var b,c,d,e,f,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="",i="",j="",k=0;do b=a.charCodeAt(k++),c=a.charCodeAt(k++),i=a.charCodeAt(k++),d=b>>2,e=(3&b)<<4|c>>4,f=(15&c)<<2|i>>6,j=63&i,isNaN(c)?f=j=64:isNaN(i)&&(j=64),h=h+g.charAt(d)+g.charAt(e)+g.charAt(f)+g.charAt(j),b=c=i="",d=e=f=j="";while(k<a.length);return h}})}),c=Class.create(Taf.ActionFactory,{check:function(a,b,c){return void 0===c.uri||0!=c.uri.indexOf("http://dbpedia.org/resource")?!1:!0},action:Class.create(Taf.Action,{display:function(){return"<span class='dbpvicon dbpvicon-lodlive'></span>"},description:"View in LodLive",execute:function(a,b,c){var d="http://en.lodlive.it/?";window.open(d+c.uri)}}),legend:{name:"LodLive",description:"View on LodLive",lines:[{icon:"<span class='dbpvicon dbpvicon-lodlive'></span>",text:"View on LodLive"}]}}),d=Class.create(Taf.ActionFactory,{check:function(a,b){return b.forward&&"http://dbpedia.org/ontology/wikiPageRedirects"==b.uri?!0:!1},action:Class.create(Taf.Action,{execute:function(a,b,c){window.location=LDViewer.preprocess_triple_url(c.uri)}})});Taf.addAction(d);var e=Class.create(Taf.ActionFactory,{check:function(a,b){return b.forward&&this.mapfrom==b.uri?!0:!1},mapfrom:"",action:f}),f=Class.create(Taf.Action,{execute:function(a,b,c){var d=this.mapto;LDViewer.applyPrettyBox(function(a){void 0===a[d]&&(a[d]=[]),a[d].push(c)})},mapto:""}),g=Class.create(e,{mapfrom:"http://www.w3.org/2000/01/rdf-schema#label",action:Class.create(f,{mapto:"label"})});Taf.addAction(g);var h=Class.create(e,{check:function(a,b,c){return b.uri==this.mapfrom&&c.uri.slice(0,this.prefiks.length)==this.prefiks?!0:!1},prefiks:"http://dbpedia.org/ontology/",mapfrom:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type",action:Class.create(f,{mapto:"types",execute:function(a,b,c){c.displayValue=c.uri.slice(this.prefiks.length,c.uri.length);var d=this.mapto;LDViewer.applyPrettyBox(function(a){void 0===a[d]&&(a[d]=[]),a[d].push(c)})},prefiks:"http://dbpedia.org/ontology/"})});Taf.addAction(h);var i=Class.create(e,{mapfrom:"http://www.w3.org/2000/01/rdf-schema#comment",action:Class.create(f,{mapto:"description"})});Taf.addAction(i);var j=Class.create(e,{mapfrom:"http://dbpedia.org/ontology/thumbnail",action:Class.create(f,{mapto:"thumbnail"})});Taf.addAction(j);var k=Class.create(Taf.ActionFactory,{check:function(a,b,c){if(b.forward){var d=this.properties[b.uri];if(d){var e=LDViewer.getPrettyPropertyAdder(b,d.prio);e&&e(c)}}return!1},properties:{"http://dbpedia.org/ontology/birthPlace":{reverse:!1,prio:1},"http://dbpedia.org/property/occupation":{reverse:!1,prio:3},"http://dbpedia.org/ontology/birthDate":{reverse:!1,prio:2},"http://dbpedia.org/ontology/areaCode":{reverse:!1,prio:4},"http://dbpedia.org/ontology/country":{reverse:!1,prio:5},"http://dbpedia.org/ontology/capital":{reverse:!1,prio:6},"http://dbpedia.org/ontology/currency":{reverse:!1,prio:7},"http://dbpedia.org/ontology/language":{reverse:!1,prio:8},"http://dbpedia.org/ontology/leaderName":{reverse:!1,prio:9},"http://dbpedia.org/ontology/wikiPageDisambiguates":{reverse:!1,prio:10}}});Taf.addAction(k);var l=Class.create(Taf.ActionFactory,{check:function(a,b,c){if(b.forward)for(var d=0;d<this.mappings.length;d++){var e=this.mappings[d];if(e.predex.test(b.uri)&&e.valuex.test(c.uri)){var f=this.mapto,g=e.label,h=e.labelx.exec(c.uri);if(!h)return!1;h=h.slice(1),c.plex=h.join(""),LDViewer.applyPrettyBox(function(a){void 0===a[f]&&(a[f]={}),void 0===a[f][g]&&(a[f][g]=[]),a[f][g].push(c)})}}return!1},mapto:"links",mappings:[{predex:new RegExp("^http://xmlns.com/foaf/0.1/isPrimaryTopicOf$"),valuex:new RegExp(".*wikipedia.*"),label:"wikipedia",labelx:new RegExp("http://([a-z]+.wikipedia.org/.+)")},{predex:new RegExp("^http://www.w3.org/2002/07/owl#sameAs$"),valuex:new RegExp(".*dbpedia.org.*"),label:"dbpedia",labelx:new RegExp("http://([a-z]+.dbpedia).org/resource(/.+)")},{predex:new RegExp("^http://www.w3.org/2002/07/owl#sameAs$"),valuex:new RegExp(".*freebase.com.*"),label:"freebase",labelx:new RegExp("^http://(.+)$")}]});Taf.addAction(l);var m=Class.create(Taf.ActionFactory,{check:function(a,b,c){if(b.forward&&b.uri==this.mapfrom){var d=c.literalLabel.val.match(/([-+]?([0-9]*\.[0-9]+|[0-9]+))\s([-+]?([0-9]*\.[0-9]+|[0-9]+))/),e=[d[3],d[1]];LDViewer.setMapCoord(e)}return!1},mapfrom:"http://www.georss.org/georss/point"});Taf.addAction(m);var n=Class.create(Taf.ActionFactory,{check:function(a,b,c){if(b.forward&&b.uri==this.mapfrom){var d=c.literalLabel.lex.match(this.regex),e=[d[1],d[3]];LDViewer.setMapCoord(e)}return!1},mapfrom:"http://www.opengis.net/ont/geosparql#asWKT",regex:/POINT\(([-+]?([0-9]*\.[0-9]+|[0-9]+))\s([-+]?([0-9]*\.[0-9]+|[0-9]+))\)/});Taf.addAction(n);var o=Class.create(Taf.ActionFactory,{check:function(a,b,c){return b.forward&&b.uri==this.latprop?o.currentLat=c.literalLabel.lex:b.forward&&b.uri==this.lonprop&&(o.currentLon=c.literalLabel.lex),void 0!==o.currentLon&&void 0!==o.currentLat&&(LDViewer.setMapCoord([o.currentLon,o.currentLat]),o.currentLon=void 0,o.currentLat=void 0),!1},latprop:"http://www.w3.org/2003/01/geo/wgs84_pos#lat",lonprop:"http://www.w3.org/2003/01/geo/wgs84_pos#long"});Taf.addAction(o);var p=Class.create(Taf.ActionFactory,{check:function(a,b){for(var c in this.mappings)if(b.uri==c&&b.forward!=this.mappings[c].reverse){var d=this.mappings[b.uri].label,e=this.mappings[b.uri].prio;LDViewer.addShortcut(b.uri,d,e)}return!1},mappings:{"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":{reverse:!1,label:"TYPES",prio:10},"http://purl.org/dc/terms/subject":{reverse:!1,label:"CATEGORIES",prio:11},"http://dbpedia.org/ontology/birthPlace":{reverse:!0,label:"Born Here",prio:1},"http://dbpedia.org/ontology/wikiPageExternalLink":{reverse:!1,label:"External Links",prio:9},"http://dbpedia.org/ontology/starring":{reverse:!0,label:"Starred in",prio:1},"http://www.w3.org/2002/07/owl#sameAs":{reverse:!1,label:"Same As",prio:8},"http://dbpedia.org/ontology/wikiPageDisambiguates":{reverse:!1,label:"Disambiguations",prio:9}}});Taf.addAction(p);var q=Class.create(Taf.ActionFactory,{check:function(a,b,c){return b.uri.match("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")&&(c.uri.match("#DatatypeProperty")||c.uri.match("#ObjectProperty")||c.uri.match("http://www.w3.org/1999/02/22-rdf-syntax-ns#Property"))&&LDViewer.showRelationInstances(),!1}}),r=Class.create(Taf.ActionFactory,{check:function(a,b,c){return b.uri.match("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")&&c.uri.match("#Class")&&LDViewer.showClassInstances(),!1}});Taf.addAction(q),Taf.addAction(r);var s=Class.create(Taf.ActionFactory,{check:function(a,b,c){if(b.uri.match("http://xmlns.com/foaf/0.1/isPrimaryTopicOf")){var d={};d.url=c.uri;var e=new RegExp("http:\\/\\/(\\w{2,4})\\.wikipedia\\.org\\/wiki\\/(.*)"),f=e.exec(c.uri),g=f[1];d.title=f[2],d.history="http://"+g+".wikipedia.org/w/index.php?title="+d.title+"&action=history",LDViewer.setFooterWikipage(d)}return!1}}),t=Class.create(Taf.ActionFactory,{check:function(a,b,c){return(b.uri.match("wikiPageExternalLink")||b.uri.match("xmlns.com/foaf/0.1/homepage"))&&(c.nofollow=!0),!1}});Taf.addAction(s),Taf.addAction(t);var u=Class.create(Taf.ActionFactory,{check:function(a,b,c){return void 0===c.literalLabel||void 0===c.literalLabel.lex||c.literalLabel.lex.length<50?!1:!0},legend:{name:"Spotlight",description:"Annotate using DBpedia Spotlight",lines:[{icon:"<span class='glyphicon glyphicon-time'></span>",text:"Annotation request pending"},{icon:"<span class='glyphicon glyphicon-bullhorn'></span>",text:"Annotate using DBpedia Spotlight"}]},action:Class.create(Taf.Action,{busy:!1,done:!1,display:function(){return this.busy?"<span class='glyphicon glyphicon-time'></span>":"<span class='glyphicon glyphicon-bullhorn'></span>"},value:void 0,endpoint:"http://spotlight.dbpedia.org/rest/annotate",execute:function(a,b,c){if(this.busy||this.done)LDViewer.addNotification("Annotation request to the DBpedia Spotlight API is already pending",5e3);else{var d=this,e=c.literalLabel.lex;LDViewer.http.get(this.endpoint+"?text="+encodeURIComponent(e)).success(function(a){if(d.busy=!1,d.done=!0,void 0!==a&&void 0!==a.Resources){for(var b=a.Resources,f=0,g=[],h=0;h<b.length;h++){var i=b[h],j=parseInt(i["@offset"]),k=i["@surfaceForm"].length,l=i["@URI"],m=LDViewer.preprocess_triple_url(l);m='<a dbpv-preview="'+l+'" href="'+m+'">',g.push(e.substring(f,j)),g.push(m+e.substr(j,k)+"</a>"),f=j+k}g.push(e.substr(f)),c.literalLabel.lex=g.join("")}}).error(function(){LDViewer.addNotification("Annotation request failed",5e3)}),this.busy=!0}}})});Taf.addAction(u);var v=(Class.create(Taf.ActionFactory,{initialize:function(a,b,c){var d=new RegExp(this.regex());if(void 0===c.uri||!d.test(c.uri))throw new"not applicable"},description:"View DBpedia mapping",display:function(){return"<span class='glyphicon glyphicon-forward'></span>"},execute:function(a,b,c){var d=new RegExp(this.regex()),e=d.exec(c.uri);void 0===e[2]&&(e[2]="en.");var f="http://mappings.dbpedia.org/index.php/Mapping_"+e[2].substring(0,e[2].length-1)+":"+e[3];window.open(f)}}),Class.create(Taf.ActionGroupFactory,{check:function(a,b,c){return void 0===c.uri||0!=c.uri.indexOf("http://dbpedia.org/resource")?!1:!0},group:[c,b],action:Class.create(Taf.ActionGroup,{display:function(){return"<span class='glyphicon glyphicon-cog'></span>"}})}));Taf.addAction(v);Class.create(Taf.ActionGroupFactory,{check:function(a,b,c){return void 0===c.uri||0!=c.uri.indexOf("http://dbpedia.org/resource")?!1:!0},group:[c,b],action:Class.create(Taf.ActionGroup,{display:function(){return"<span class='glyphicon glyphicon-cog'></span>"}})})}();